!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@angular/core"),require("rxjs")):"function"==typeof define&&define.amd?define("ng-angular",["exports","@angular/core","rxjs"],n):n(e["ng-angular"]={},e.ng.core,e.rxjs)}(this,function(e,n,t){"use strict";var r=require("web3"),o=require("ansiblejs"),s=require("../ansible_relay.abi"),a=function(){},i=function(){},l=function(){function e(){var n=this;this.ansibleRelayAddress="0x0",this.relayID=0,this.FULL_RANGE={fromBlock:0,toBlock:"latest"},this.checkAndInstantiateWeb3=function(){"undefined"!=typeof window.web3?(console.warn("Using web3 detected from external source. If you find that your accounts don't appear or you have 0 MetaCoin, ensure you've configured that source properly. If using MetaMask, see the following link. Feel free to delete this warning. :) http://truffleframework.com/tutorials/truffle-and-metamask"),n.web3=new r(window.web3.currentProvider)):n.web3=new r(new r.providers.HttpProvider("http://localhost:8545"))},this.checkAndInstantiateWeb3(),this.ansibleRelay=this.web3.eth.contract(s).at(this.ansibleRelayAddress),this.getAccounts().subscribe(function(e){n.accounts=e,n.account=n.accounts[0]},function(e){return alert(e)})}return e.prototype.signInitialAnsible=function(e,n){var t=this.createInitialState(e,n);return this.sign(t)},e.prototype.createInitialState=function(e,n){var t=[];return t=o.appendUint16(t,this.relayID),(t=o.appendAddress(t,e)).concat(n),t},e.prototype.createAnsibleState=function(e,n){var t=[];return t=o.appendUint16(t,this.relayID),(t=o.appendUint64(t,e)).concat(n),t},e.prototype.signAnsibleState=function(e,n){var t=this.createAnsibleState(e,n);return this.sign(t)},e.prototype.sign=function(e){var n=this;return t.Observable.create(function(r){n.web3.eth.sign(n.account,e,function(e,n){if(e)r.error(e);else{var t=new a;t.data=n.substr(2,n.length),t.rs=["0x"+t.data.substr(0,64)],t.ss=["0x"+t.data.substr(64,64)],t.vs=[parseInt(t.data.substr(128,2),16)],r.next(t)}})})},e.prototype.getAccounts=function(){var e=this;return t.Observable.create(function(t){e.web3.eth.getAccounts(function(e,n){null!=e&&t.error("There was an error fetching your accounts."),0===n.length&&t.error("Couldn't get any accounts! Make sure your Ethereum client is configured correctly."),t.next(n),t.complete()})})},e.prototype.get=function(e){var n=this;return t.Observable.create(function(t){n.ansibleRelay.getAnsible.call(e,function(e,n){null==e?(t.next(n),t.complete()):t.error(e)})})},e.prototype.open=function(e,n,r){var o=this;return t.Observable.create(function(t){o.ansibleRelay.openAnsible.call(e,n.data,n.vs,n.rs,n.ss,{value:r},function(e,n){null==e?(t.next(n),t.complete()):t.error(e)})})},e.prototype.join=function(e,n,r){var o=this;return t.Observable.create(function(t){o.ansibleRelay.joinAnsible.call(e,n.data,n.vs,n.rs,n.ss,{value:r},function(e,n){null==e?(t.next(n),t.complete()):t.error(e)})})},e.prototype.challenge=function(e,n,r){var o=this;return t.Observable.create(function(t){o.ansibleRelay.challenge.call(e,n.data,n.vs,n.rs,n.ss,r.data,r.vs,r.rs,r.ss,function(e,n){null==e?(t.next(n),t.complete()):t.error(e)})})},e.prototype.challengeState=function(e,n){var r=this;return t.Observable.create(function(t){r.ansibleRelay.challengeState.call(e,n.data,n.vs,n.rs,n.ss,function(e,n){null==e?(t.next(n),t.complete()):t.error(e)})})},e.prototype.checkpoint=function(e,n,r){var o=this;return t.Observable.create(function(t){o.ansibleRelay.checkpoint.call(e,n,r.data,r.vs,r.rs,r.ss,function(e,n){null==e?(t.next(n),t.complete()):t.error(e)})})},e.prototype.claimExpiry=function(e){var n=this;return t.Observable.create(function(t){n.ansibleRelay.claimExpiry.call(e,function(e,n){null==e?(t.next(n),t.complete()):t.error(e)})})},e.prototype.close=function(e,n){var r=this;return t.Observable.create(function(t){r.ansibleRelay.closeAnsible.call(e,n.data,n.rs,n.vs,n.ss,function(e,n){null!=e&&t.error(e),t.next(n),t.complete()})})},e.prototype.getSpeakerEvents=function(e){var n={speaker:e};return this.getEvents(n)},e.prototype.getAnsibleEvents=function(e){var n={id:e};return this.getEvents(n)},e.prototype.getEvents=function(e){var n=this,r=0,o=[];return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleOpened(e,n.FULL_RANGE).get(function(e,n){e?t.error(e):(o.concat(n.json()),6==++r&&(t.next(o),t.complete()))}),n.ansibleRelay.events.AnsibleJoined(e,n.FULL_RANGE).get(function(e,n){e?t.error(e):(o.concat(n.json()),6==++r&&(t.next(o),t.complete()))}),n.ansibleRelay.events.AnsibleClosed(e,n.FULL_RANGE).get(function(e,n){e?t.error(e):(o.concat(n.json()),6==++r&&(t.next(o),t.complete()))}),n.ansibleRelay.events.AnsibleExpired(e,n.FULL_RANGE).get(function(e,n){e?t.error(e):(o.concat(n.json()),6==++r&&(t.next(o),t.complete()))}),n.ansibleRelay.events.AnsibleCheckpoint(e,n.FULL_RANGE).get(function(e,n){e?t.error(e):(o.concat(n.json()),6==++r&&(t.next(o),t.complete()))}),n.ansibleRelay.events.AnsibleChallenged(e,n.FULL_RANGE).get(function(e,n){e?t.error(e):(o.concat(n.json()),6==++r&&(t.next(o),t.complete()))})})},e.prototype.getSpeakerOpens=function(e){var n=this,r={speaker:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleOpened(r,n.FULL_RANGE).get(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.getSpeakerCloses=function(e){var n=this,r={speaker:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleClosed(r,n.FULL_RANGE).get(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.getSpeakerChallenges=function(e){var n=this,r={speaker:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleChallenged(r,n.FULL_RANGE).get(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.getSpeakerClaims=function(e){var n=this,r={speaker:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleClaimed(r,n.FULL_RANGE).get(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.getSpeakerJoins=function(e){var n=this,r={speaker:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleJoined(r,n.FULL_RANGE).get(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.getSpeakerCheckpoints=function(e){var n=this,r={speaker:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleCheckpoint(r,n.FULL_RANGE).get(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.getAnsibleOpens=function(e){var n=this,r={id:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleOpened(r,n.FULL_RANGE).get(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.getAnsibleCloses=function(e){var n=this,r={id:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleClosed(r,n.FULL_RANGE).get(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.getAnsibleChallenges=function(e){var n=this,r={id:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleChallenged(r,n.FULL_RANGE).get(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.getAnsibleClaims=function(e){var n=this,r={id:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleClaimed(r,n.FULL_RANGE).get(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.getAnsibleJoins=function(e){var n=this,r={id:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleJoined(r,n.FULL_RANGE).get(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.getAnsibleCheckpoints=function(e){var n=this,r={id:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleCheckpoints(r,n.FULL_RANGE).get(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.watchSpeakerOpens=function(e){var n=this,r={speaker:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleOpened(r).watch(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.watchSpeakerCloses=function(e){var n=this,r={speaker:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleClosed(r).watch(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.watchSpeakerChallenges=function(e){var n=this,r={speaker:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleChallenged(r).watch(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.watchSpeakerClaims=function(e){var n=this,r={speaker:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleClaimed(r).watch(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.watchSpeakerJoins=function(e){var n=this,r={speaker:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleJoined(r).watch(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.watchSpeakerCheckpoints=function(e){var n=this,r={speaker:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleCheckpoint(r).watch(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.watchAnsibleCloses=function(e){var n=this,r={id:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleClosed(r).watch(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.watchAnsibleChallenges=function(e){var n=this,r={id:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleChallenged(r).watch(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.watchAnsibleClaims=function(e){var n=this,r={speaker:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleClaimed(r).watch(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.watchAnsibleJoins=function(e){var n=this,r={id:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleJoined(r).watch(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.watchAnsibleCheckpoints=function(e){var n=this,r={id:e};return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleCheckpoint(r).watch(function(e,n){e?t.error(e):t.next(n.json())})})},e.prototype.watchSpeakerEvents=function(e){var n={speaker:e};return this.watchEvents(n)},e.prototype.watchAnsibleEvents=function(e){var n={id:e};return this.watchEvents(n)},e.prototype.watchEvents=function(e){var n=this;return t.Observable.create(function(t){n.ansibleRelay.events.AnsibleOpened(e).watch(function(e,n){e?t.error(e):t.next(n.json())}),n.ansibleRelay.events.AnsibleJoined(e).watch(function(e,n){e?t.error(e):t.next(n.json())}),n.ansibleRelay.events.AnsibleClosed(e).watch(function(e,n){e?t.error(e):t.next(n.json())}),n.ansibleRelay.events.AnsibleExpired(e).watch(function(e,n){e?t.error(e):t.next(n.json())}),n.ansibleRelay.events.AnsibleCheckpoint(e).watch(function(e,n){e?t.error(e):t.next(n.json())}),n.ansibleRelay.events.AnsibleChallenged(e).watch(function(e,n){e?t.error(e):t.next(n.json())})})},e}();l.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],l.ctorParameters=function(){return[]},l.ngInjectableDef=n.defineInjectable({factory:function(){return new l},token:l,providedIn:"root"}),e.SignedState=a,e.AnsibleEvent=i,e.AnsibleService=l,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ng-angular.umd.min.js.map
